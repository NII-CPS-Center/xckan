# 詳細画面、タイトルの日本語表示ファイルの変換プログラムについて

このプログラムは、python3で動作する、データカタログ検索システムの詳細画面のタイトルを作成するプログラムです。

## 実行方法

```
$ python convert.py
```

## 配置方法

実行後に作成された `dataset.ts` ファイルは、アプリケーションディレクトリにコピーします。

```
$ cp dataset.ts ../app/sip2-ckan/data/dataset.ts
```

反映するには、サーバを再起動します。

## dataset.ts ファイルの形式について

`dataset.ts` ファイルは詳細画面で表示する日本語と、レスポンスで返信されるキーをマッピングしたものです。

```
{
    "レスポンスのキー": "表示したい日本語"
}
```
の形式で、構成されています。

CKANのレスポンスには、入れ子になったデータが返信に含まれます。詳細画面では、
「組織」「キーワード」「グループ」「配信」「付加情報」の５つの辞書型のレスポンスを別々のセクションで表示しています。
上記のレスポンスのタイトルの日本語を変更したい場合は、

- organization
- tag
- group
- resource
- extras

を"レスポンスキー"の接頭辞として利用し、":"区切りで、変換したいキーを続けて書くようにします。

例えば、以下のようなレスポンスに対して、組織の説明のタイトルを変更したい場合は、

```
{
    "organization": {
        "description": "日本海溝・千島海溝周辺海溝型地震に関する専門調査会（中央防災会議）において検討を行なった各地震における震度分布・浸水域等に係るデータです…"
    }
}
```

```
{
    "organization:description": "説明"
}
```

とすると、タイトルが「組織」と表示されます。


## 新しいデータセットを利用する

元データとなるエクセルファイルが更新された場合は、エクセルファイルからUTF-8形式でcsvファイルを作成してください。

作成したファイルは、`dataset.csv` という名前で、このディレクトリに配置し、`convert.py` を実行してください。